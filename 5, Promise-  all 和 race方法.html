<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="author" content="刘亚彬">
		<title>Promise-all 和 race 类方法</title>
		<style>

		</style>
	</head>

	<body>

	</body>
	<script type="text/javascript">
		var p1 = new Promise(function(resolve, reject) {
			setTimeout(function() {
				if(Math.random() > 0.5) {
					resolve('买到地了')
				} else {
					reject('没买到地')
				}
			}, Math.random() * 1000)
		})
		var p2 = new Promise(function(resolve, reject) {
			setTimeout(function() {
				if(Math.random() > 0.5) {
					resolve('买到建筑材料了')
				} else {
					reject('没买到建筑材料')
				}
			}, Math.random() * 1000)
		})
		var p3 = new Promise(function(resolve, reject) {
			setTimeout(function() {
				if(Math.random() > 0.5) {
					resolve('建造房子成功')
				} else {
					reject('建造房子失败')
				}
			}, Math.random() * 1000)
		})
		
		
		//all() 和 race()  类方法: 类(构造函数)本身调用的方法
		
		//all: 所有的    参数是一个数组,数组中是多个promise对象
		//当数组中的所有promise对象都变成了resolve状态,才会执行这个promise对象then方法的成功的回调
		//p1,p2,p3都成功,p才会成功 ,有一个失败,p就失败
		var p = Promise.all([p1,p2,p3])
		
		p.then(function(value){
			console.log('p 成功+' + value)
		},function(error){
			console.log('p 失败+' + error)
		})
		
		
		
		//race:  参数是一个数组,数组中是多个promise对象
		//当数组中有一个promise对象改变了状态,就会改变p的状态
		//p1,p2,p3有一个得到了结果,无论成功还是失败,p就会得到相同的结果
		var pp = Promise.race([p1,p2,p3])
		
		pp.then(function(value){
			console.log('pp 成功+' + value)
		},function(error){
			console.log('pp 失败+' + error)
		})
		
		
		
		
		
	</script>

</html>